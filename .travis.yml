language: php

services:
  - docker

php:
  - '7.2'

git:
  depth: 1

before_install:
  - composer install
  - vendor/unb-libraries/dockworker/scripts/travis/init.sh

script:
  - set -e
  - vendor/bin/dockworker local:build-test
  - vendor/unb-libraries/dockworker/scripts/kubectl/init.sh
  - vendor/bin/dockworker image:deploy $TRAVIS_BRANCH

notifications:
  slack:
    rooms:
      secure: QoSPt0v9MgFVaWS6PIJcSob4VwfYPiwr9JCxJhUq+/7kozjoy/6DV1YD/eT3gc6lypjOOm+8KGbIpDYPeth9JyO7xKX/0v+6l1Rrpagy8OmFkIFW3FOu3bY2w8oKPwgvMMaeBQYFabHfEuQzg5qx00GIZrCMUDGpXZRNYBIh/mqB6ej6fpuor6HX4i6g/D48skd/aMogi3Ek7wRif6VmpyA9DrvpXjKIgRg2jGhK4bardA5E/mbJW8a07hTNL8G3kC/zaJoI0UrmWXJQmw26tyoLBelGTVOISmyWR0T4fPvyCbc+4BLcDvOcVvRODznDDtXfOda9O9grLVAeJK4iN6s4DDCfMea7AWAvoao1pgYBx8Kdk4pLR2CgHLJjyBhgXSku6I4mUWdKcXX8266ttN3crGF23bOGd3XLfzUJZ1UWV2hCQvyrNaN8FsfbeUOD4EVWuJHyy9UueztSNLlgh1YQBomxLFYfqFCmZgljUWlbZDj/AeqQHjdPvmeTpyLWf10cI16XM2jnhf2IR/0GqUaRNp60DVrZqLhariAd3yA8Ei6Rrfkhua4QXBeVTfAE+WR5WSKefjDPhG/97XBAD01Cl38+2Jsz9ASZD4qn65xeSUPb5pgM7MNRdw2LFMAf9GD8ZK1Y5/QIfUbrqg5TEdC2NK3jOzVgduCJztZqDR0=
    on_start: always
    on_success: always
